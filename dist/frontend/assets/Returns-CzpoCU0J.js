import{j as e}from"./framer-motion-CP1hDTrg.js";import{r as s}from"./react-vendor-CFOUl9e9.js";import{g as t}from"./index-D8_-wRmV.js";import{R as a,P as r,C as l,d as i,T as d,D as n,e as c,E as o,f as x,g as m}from"./lucide-Jis9dCxC.js";const u=()=>{const[u,p]=s.useState([]),[h,g]=s.useState(!0),[j,v]=s.useState(null),[y,f]=s.useState(!1),[N,b]=s.useState(!1),[w,_]=s.useState(!1),[S,R]=s.useState(null),[k,C]=s.useState(""),[P,A]=s.useState(""),[$,D]=s.useState({approval_status:"",receipt_status:"",status:"",date_range:""}),[I,M]=s.useState(""),[T,L]=s.useState(!1),[U,z]=s.useState(1),[E,F]=s.useState(0),[O]=s.useState(50),Y=async(e=U)=>{try{g(!0);const s=await fetch(t(`/api/returns?page=${e}&limit=${O}`),{credentials:"include"});if(s.ok){const e=await s.json();p(e.returns||[]),e.pagination&&F(e.pagination.total)}}catch(s){}finally{g(!1)}};s.useEffect(()=>{Y()},[]),s.useEffect(()=>{z(1),Y(1)},[I,$.approval_status,$.receipt_status,$.status]);const q=["hallelujah","hahaha","yezzir","suuure","mmmhhmm","ovio"],H=(e,s)=>{if(!j)return;const t=j[e];if(t===s)return;if(!J(e,t,s,j))return void alert("Invalid status change. Please follow the logical progression rules.");if("approval_status"===e&&"rejected"===s)R({field:"approval_status",value:"rejected",label:"Reject approval (will also set receipt to rejected)"});else{R({field:e,value:s,label:((e,s)=>{switch(e){case"approval_status":return"approved"===s?"Approve":"rejected"===s?"Reject":"Set Pending";case"receipt_status":return"received"===s?"Mark as Received":"rejected"===s?"Reject Receipt":"Set Pending";case"status":return"processed"===s?"Mark as Processed":"Set Pending";default:return`Set ${s}`}})(e,s)})}const a=(()=>{const e=Math.floor(Math.random()*q.length);return q[e]})();A(a),C(""),_(!0)},J=(e,s,t,a)=>{if(!a)return!1;if("approval_status"===e)return"pending"===s&&["approved","rejected"].includes(t);if("receipt_status"===e){if("pending"===a.approval_status)return!1;if("rejected"===a.approval_status)return"rejected"===t;if("approved"===a.approval_status)return"received"!==s&&("pending"===s&&["received","rejected"].includes(t))}if("status"===e){if("pending"===a.receipt_status)return!1;if("received"===a.receipt_status)return"processed"===t;if("rejected"===a.receipt_status)return!1;if("processed"===s)return!1}return!1},K=u.filter(e=>{const s=""===I||e.return_id.toString().includes(I)||e.order_id.toString().includes(I)||e.customer_name.toLowerCase().includes(I.toLowerCase())||e.customer_phone.includes(I),t=""===$.approval_status||e.approval_status===$.approval_status,a=""===$.receipt_status||e.receipt_status===$.receipt_status,r=""===$.status||e.status===$.status;return s&&t&&a&&r}),Q=(e,s)=>{const t="px-2 py-1 rounded-full text-xs font-medium";switch(s){case"approval":switch(e){case"approved":return`${t} bg-green-100 text-green-800`;case"rejected":return`${t} bg-red-100 text-red-800`;default:return`${t} bg-yellow-100 text-yellow-800`}case"receipt":switch(e){case"received":return`${t} bg-blue-100 text-blue-800`;case"inspected":return`${t} bg-purple-100 text-purple-800`;case"rejected":return`${t} bg-red-100 text-red-800`;default:return`${t} bg-gray-100 text-gray-800`}case"status":return"processed"===e?`${t} bg-green-100 text-green-800`:`${t} bg-yellow-100 text-yellow-800`;default:return`${t} bg-gray-100 text-gray-800`}},V=(s,t)=>{switch(t){case"approval":switch(s){case"approved":return e.jsx(i,{className:"w-4 h-4"});case"rejected":return e.jsx(x,{className:"w-4 h-4"});default:return e.jsx(l,{className:"w-4 h-4"})}case"receipt":switch(s){case"received":return e.jsx(r,{className:"w-4 h-4"});case"inspected":return e.jsx(o,{className:"w-4 h-4"});case"rejected":return e.jsx(x,{className:"w-4 h-4"});default:return e.jsx(l,{className:"w-4 h-4"})}case"status":return"processed"===s?e.jsx(i,{className:"w-4 h-4"}):e.jsx(l,{className:"w-4 h-4"});default:return e.jsx(l,{className:"w-4 h-4"})}},B={total:u.length,pending:u.filter(e=>"pending"===e.approval_status).length,approved:u.filter(e=>"approved"===e.approval_status).length,received:u.filter(e=>"received"===e.receipt_status).length,processed:u.filter(e=>"processed"===e.status).length,totalRefund:u.reduce((e,s)=>e+parseFloat(s.total_refund_amount.toString()),0)};return h?e.jsxs("div",{className:"flex items-center justify-center h-64 bg-gray-900",children:[e.jsx(a,{className:"w-8 h-8 animate-spin text-blue-400"}),e.jsx("span",{className:"ml-2 text-gray-300",children:"Loading returns..."})]}):e.jsxs("div",{className:"p-6 space-y-6 bg-gray-900 min-h-screen",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-indigo-400",children:"Return Management"}),e.jsx("p",{className:"text-gray-300",children:"Track and manage product returns"})]}),e.jsxs("button",{onClick:()=>Y(),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(a,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[e.jsx("div",{className:"bg-gray-800 p-4 rounded-lg shadow border border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(r,{className:"w-8 h-8 text-blue-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Total Returns"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:B.total})]})]})}),e.jsx("div",{className:"bg-gray-800 p-4 rounded-lg shadow border border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(l,{className:"w-8 h-8 text-yellow-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Pending Approval"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:B.pending})]})]})}),e.jsx("div",{className:"bg-gray-800 p-4 rounded-lg shadow border border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(i,{className:"w-8 h-8 text-green-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Approved"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:B.approved})]})]})}),e.jsx("div",{className:"bg-gray-800 p-4 rounded-lg shadow border border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(d,{className:"w-8 h-8 text-purple-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Received"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:B.received})]})]})}),e.jsx("div",{className:"bg-gray-800 p-4 rounded-lg shadow border border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(i,{className:"w-8 h-8 text-green-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Processed"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:B.processed})]})]})}),e.jsx("div",{className:"bg-gray-800 p-4 rounded-lg shadow border border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(n,{className:"w-8 h-8 text-green-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Total Refund"}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:["₹",B.totalRefund.toFixed(2)]})]})]})})]}),e.jsx("div",{className:"bg-gray-800 p-4 rounded-lg shadow border border-gray-700",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search by return ID, order ID, customer name, or phone...",value:I,onChange:e=>M(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-700 text-white placeholder-gray-400"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:$.approval_status,onChange:e=>D({...$,approval_status:e.target.value}),className:"px-3 py-2 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-gray-700 text-white",children:[e.jsx("option",{value:"",children:"All Approval Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]}),e.jsxs("select",{value:$.receipt_status,onChange:e=>D({...$,receipt_status:e.target.value}),className:"px-3 py-2 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-gray-700 text-white",children:[e.jsx("option",{value:"",children:"All Receipt Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"received",children:"Received"}),e.jsx("option",{value:"inspected",children:"Inspected"}),e.jsx("option",{value:"rejected",children:"Rejected"})]}),e.jsxs("select",{value:$.status,onChange:e=>D({...$,status:e.target.value}),className:"px-3 py-2 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-gray-700 text-white",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processed",children:"Processed"})]})]})]})}),e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow border border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Return Details"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Order Info"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:K.map(s=>e.jsxs("tr",{className:"hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-white",children:["Return #",s.return_id]}),e.jsx("div",{className:"text-sm text-gray-300",children:new Date(s.return_date).toLocaleDateString()}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[s.return_items.length," item(s)"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:s.customer_name}),e.jsx("div",{className:"text-sm text-gray-300",children:s.customer_phone}),s.customer_email&&e.jsx("div",{className:"text-xs text-gray-400",children:s.customer_email})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-white",children:["Order #",s.order_id]}),e.jsx("div",{className:"text-sm text-gray-300",children:new Date(s.order_date).toLocaleDateString()}),e.jsxs("div",{className:"text-xs text-gray-400",children:["₹",s.order_total]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center",children:[V(s.approval_status,"approval"),e.jsx("span",{className:`ml-1 ${Q(s.approval_status,"approval")}`,children:s.approval_status})]}),e.jsxs("div",{className:"flex items-center",children:[V(s.receipt_status,"receipt"),e.jsx("span",{className:`ml-1 ${Q(s.receipt_status,"receipt")}`,children:s.receipt_status})]}),e.jsxs("div",{className:"flex items-center",children:[V(s.status,"status"),e.jsx("span",{className:`ml-1 ${Q(s.status,"status")}`,children:s.status})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-medium text-white",children:["₹",s.total_refund_amount]}),e.jsx("div",{className:"text-xs text-gray-400",children:"Refund Amount"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>{v(s),f(!0)},className:"text-blue-600 hover:text-blue-900 flex items-center",children:[e.jsx(o,{className:"w-4 h-4 mr-1"}),"View"]}),e.jsxs("button",{onClick:()=>{v(s),b(!0)},className:"text-green-600 hover:text-green-900 flex items-center",disabled:T,children:[e.jsx(a,{className:"w-4 h-4 mr-1 "+(T?"animate-spin":"")}),"Update"]})]})})]},s.return_id))})]})}),0===K.length&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(r,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No returns found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:I||Object.values($).some(e=>""!==e)?"Try adjusting your search or filters.":"No returns have been submitted yet."})]})]}),Math.ceil(E/O)>1&&e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-gray-800 border-t border-gray-700",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-300",children:["Showing ",(U-1)*O+1," to ",Math.min(U*O,E)," of ",E," results"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{const e=Math.max(U-1,1);z(e),Y(e)},disabled:1===U,className:"px-3 py-1 text-sm border border-gray-600 rounded-md bg-gray-700 text-gray-300 hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsxs("span",{className:"px-3 py-1 text-sm text-gray-300",children:["Page ",U," of ",Math.ceil(E/O)]}),e.jsx("button",{onClick:()=>{const e=Math.min(U+1,Math.ceil(E/O));z(e),Y(e)},disabled:U===Math.ceil(E/O),className:"px-3 py-1 text-sm border border-gray-600 rounded-md bg-gray-700 text-gray-300 hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),y&&j&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border border-gray-700 w-11/12 max-w-4xl shadow-lg rounded-md bg-gray-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-white",children:["Return Details - #",j.return_id]}),e.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(x,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white mb-2",children:"Return Information"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-300",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-white",children:"Return ID:"})," #",j.return_id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-white",children:"Order ID:"})," #",j.order_id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-white",children:"Return Date:"})," ",new Date(j.return_date).toLocaleDateString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-white",children:"Reason:"})," ",j.reason]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-white",children:"Refund Amount:"})," ₹",j.total_refund_amount]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white mb-2",children:"Customer Information"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-300",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-white",children:"Name:"})," ",j.customer_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-white",children:"Phone:"})," ",j.customer_phone]}),j.customer_email&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-white",children:"Email:"})," ",j.customer_email]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white mb-3",children:"Status Timeline"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[V(j.approval_status,"approval"),e.jsxs("span",{className:"ml-2 text-sm text-gray-300",children:[e.jsx("span",{className:"font-medium text-white",children:"Approval Status:"}),e.jsx("span",{className:`ml-2 ${Q(j.approval_status,"approval")}`,children:j.approval_status})]})]}),e.jsxs("div",{className:"flex items-center",children:[V(j.receipt_status,"receipt"),e.jsxs("span",{className:"ml-2 text-sm text-gray-300",children:[e.jsx("span",{className:"font-medium text-white",children:"Receipt Status:"}),e.jsx("span",{className:`ml-2 ${Q(j.receipt_status,"receipt")}`,children:j.receipt_status})]})]}),e.jsxs("div",{className:"flex items-center",children:[V(j.status,"status"),e.jsxs("span",{className:"ml-2 text-sm text-gray-300",children:[e.jsx("span",{className:"font-medium text-white",children:"Processing Status:"}),e.jsx("span",{className:`ml-2 ${Q(j.status,"status")}`,children:j.status})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white mb-3",children:"Returned Items"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-300 uppercase",children:"Product"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-300 uppercase",children:"SKU"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-300 uppercase",children:"Quantity"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-300 uppercase",children:"Unit Price"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-300 uppercase",children:"Total"})]})}),e.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:j.return_items.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:s.product_name}),e.jsxs("div",{className:"text-gray-300",children:[s.brand," - ",s.category]})]})}),e.jsx("td",{className:"px-4 py-2 text-sm text-white",children:s.sku}),e.jsx("td",{className:"px-4 py-2 text-sm text-white",children:s.quantity}),e.jsxs("td",{className:"px-4 py-2 text-sm text-white",children:["₹",s.unit_price]}),e.jsxs("td",{className:"px-4 py-2 text-sm text-white",children:["₹",s.total_amount]})]},s.return_item_id))})]})})]})]})]})}),N&&j&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-11/12 max-w-2xl shadow-lg rounded-md bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Update Return Status - #",j.return_id]}),e.jsx("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(x,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Approval Status"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",value:j.approval_status,onChange:e=>H("approval_status",e.target.value),children:[e.jsxs("option",{value:"pending",disabled:"pending"!==j.approval_status,children:["Pending ","pending"!==j.approval_status&&"(Already Set)"]}),e.jsxs("option",{value:"approved",disabled:!J("approval_status",j.approval_status,"approved",j),children:["Approved ","approved"===j.approval_status&&"(Already Set)"]}),e.jsxs("option",{value:"rejected",disabled:!J("approval_status",j.approval_status,"rejected",j),children:["Rejected ","rejected"===j.approval_status&&"(Already Set)"]})]}),"pending"!==j.approval_status&&e.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"⚠️ Status changes are irreversible"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Receipt Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",value:j.receipt_status,onChange:e=>H("receipt_status",e.target.value),children:[e.jsxs("option",{value:"pending",disabled:"pending"!==j.receipt_status,children:["Pending ","pending"!==j.receipt_status&&"(Already Set)"]}),e.jsxs("option",{value:"received",disabled:!J("receipt_status",j.receipt_status,"received",j),children:["Received (Triggers Inventory Restock) ","received"===j.receipt_status&&"(Already Set)"]}),e.jsxs("option",{value:"rejected",disabled:!J("receipt_status",j.receipt_status,"rejected",j),children:["Rejected ","rejected"===j.receipt_status&&"(Already Set)"]})]}),"pending"===j.approval_status&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"⚠️ Must approve or reject the return first"}),"approved"===j.approval_status&&"pending"===j.receipt_status&&e.jsx("p",{className:"text-xs text-blue-500 mt-1",children:'ℹ️ You can now mark as "Received" to restock inventory'}),"rejected"===j.approval_status&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"⚠️ Return rejected - receipt status automatically set to rejected"}),"received"===j.receipt_status&&e.jsx("p",{className:"text-xs text-green-500 mt-1",children:"✅ Inventory has been restocked - cannot change receipt status anymore"}),"pending"!==j.receipt_status&&e.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"⚠️ Status changes are irreversible"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Processing Status"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",value:j.status,onChange:e=>H("status",e.target.value),children:[e.jsxs("option",{value:"pending",disabled:"pending"!==j.status,children:["Pending ","pending"!==j.status&&"(Already Set)"]}),e.jsxs("option",{value:"processed",disabled:!J("status",j.status,"processed",j),children:["Processed ","processed"===j.status&&"(Already Set)"]})]}),"pending"===j.receipt_status&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"⚠️ Must set receipt status first (received or rejected)"}),"received"===j.receipt_status&&"pending"===j.status&&e.jsx("p",{className:"text-xs text-blue-500 mt-1",children:'ℹ️ You can now mark as "Processed" to complete the return'}),"rejected"===j.receipt_status&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"⚠️ Cannot process a rejected return"}),"processed"===j.status&&e.jsx("p",{className:"text-xs text-green-500 mt-1",children:"✅ Return processing completed"})]})]})]})}),w&&S&&j&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border border-gray-700 w-11/12 max-w-md shadow-lg rounded-md bg-gray-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Confirm Status Change"}),e.jsx("button",{onClick:()=>{_(!1),R(null),C(""),A("")},className:"text-gray-400 hover:text-gray-600",children:e.jsx(x,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-yellow-900 border border-yellow-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(m,{className:"w-5 h-5 text-yellow-400 mt-0.5 mr-3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-200",children:"Irreversible Action"}),e.jsxs("p",{className:"text-sm text-yellow-300 mt-1",children:["You are about to ",e.jsx("strong",{children:S.label})," for Return #",j.return_id,". This action cannot be undone."]})]})]})}),"receipt_status"===S.field&&"received"===S.value&&e.jsx("div",{className:"bg-blue-900 border border-blue-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(r,{className:"w-5 h-5 text-blue-400 mt-0.5 mr-3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-200",children:"Inventory Restock"}),e.jsx("p",{className:"text-sm text-blue-300 mt-1",children:"This will automatically restock inventory for all returned items."})]})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Enter confirmation word: ",e.jsx("span",{className:"font-mono text-lg font-bold text-blue-400",children:P})]}),e.jsx("input",{type:"text",placeholder:"Type the word shown above",value:k,onChange:e=>C(e.target.value),className:"w-full px-3 py-2 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center text-lg bg-gray-700 text-white placeholder-gray-400"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{onClick:()=>{_(!1),R(null),C(""),A("")},className:"flex-1 px-4 py-2 border border-gray-600 rounded-lg text-gray-300 hover:bg-gray-700 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(S&&j)if(k.toLowerCase()===P.toLowerCase())try{L(!0);const e={[S.field]:S.value},s=await fetch(`/api/returns/${j.return_id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(s.ok){const t=await s.json();await Y(U),v({...j,...e}),alert(t.message),_(!1),b(!1),R(null),C(""),A("")}else{const e=await s.json();alert(`Failed to update status: ${e.message}`)}}catch(e){alert("Failed to update return status")}finally{L(!1)}else alert("You typed wrong! Please enter the exact word shown above.")},disabled:T||!k.trim(),className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:T?e.jsxs(e.Fragment,{children:[e.jsx(a,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating..."]}):"Confirm & Update"})]})]})]})})]})};export{u as default};
