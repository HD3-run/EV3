import{j as e}from"./framer-motion-CP1hDTrg.js";import{r as t}from"./react-vendor-CFOUl9e9.js";import{f as a}from"./currency-CLTscsdx.js";import{g as r}from"./index-Zg8dsWBS.js";import"./lucide-Jis9dCxC.js";function s(){const[s,l]=t.useState([]),[d,i]=t.useState(!0),[o,n]=t.useState(null),[c,x]=t.useState(""),[g,y]=t.useState("all"),[m,p]=t.useState("all"),[h,u]=t.useState([]),[b,k]=t.useState(1),[j,w]=t.useState(0),f=50;t.useEffect(()=>{v()},[]),t.useEffect(()=>{k(1),v(1)},[c,g,m]);const v=async(e=b)=>{try{n(null);const t=new URLSearchParams({limit:f.toString(),page:e.toString()});c&&t.append("search",c),g&&"all"!==g&&t.append("category",g),m&&"all"!==m&&t.append("stockStatus",m);const a=await fetch(r(`/api/inventory?${t.toString()}`),{credentials:"include"});if(!a.ok){const e=await a.text();return n(`Failed to load inventory: ${a.status} - ${e}`),void l([])}const s=await a.json();if(s.products&&Array.isArray(s.products)){const e=s.products;l(e),s.pagination&&s.pagination.total?w(s.pagination.total):w(e.length);const t=Array.from(new Set(e.map(e=>e.category).filter(e=>!!e)));u(t)}else l([]),s.debug}catch(t){n(t instanceof Error?t.message:"Failed to load inventory"),l([])}finally{i(!1)}},N=s.filter(e=>{const t=e.product_name.toLowerCase().includes(c.toLowerCase())||e.sku.toLowerCase().includes(c.toLowerCase()),a="all"===g||e.category===g,r="all"===m||"low"===m&&e.quantity_available<=e.reorder_level||"in"===m&&e.quantity_available>e.reorder_level;return t&&a&&r}),S=s.filter(e=>e.quantity_available<=e.reorder_level).length,_=s.filter(e=>0===e.quantity_available).length;return d?e.jsxs("div",{className:"p-4 sm:p-6 md:p-8 min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"Inventory"}),e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Loading inventory..."})]})})]}):e.jsxs("div",{className:"p-4 sm:p-6 md:p-8 min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"Inventory"}),o&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"font-bold",children:"Error Loading Inventory:"}),e.jsx("span",{className:"block sm:inline ml-2",children:o})]}),e.jsx("button",{onClick:()=>{n(null),v()},className:"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600",children:"Retry"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300",children:"Total Products"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:j})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300",children:"Low Stock"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:S})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300",children:"Out of Stock"}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:_})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 space-y-4 sm:space-y-0 sm:space-x-4",children:[e.jsx("input",{type:"text",placeholder:"Search by product name or SKU...",className:"p-2 border border-gray-300 dark:border-gray-700 rounded-md w-full sm:w-auto bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:c,onChange:e=>x(e.target.value)}),e.jsxs("select",{className:"p-2 border border-gray-300 dark:border-gray-700 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:g,onChange:e=>y(e.target.value),children:[e.jsx("option",{value:"all",children:"All Categories"}),h.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{className:"p-2 border border-gray-300 dark:border-gray-700 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:m,onChange:e=>p(e.target.value),children:[e.jsx("option",{value:"all",children:"All Stock"}),e.jsx("option",{value:"in",children:"In Stock"}),e.jsx("option",{value:"low",children:"Low Stock"})]})]}),e.jsx("div",{className:"overflow-x-auto bg-white dark:bg-gray-800 rounded-lg shadow",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Product Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"SKU"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Category"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Stock"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Reorder Level"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Unit Price"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:0===N.length?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"No products found."})}):N.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:t.product_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:t.sku}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:t.category||"Uncategorized"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:t.quantity_available}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:t.reorder_level}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a(t.unit_price)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(0===t.quantity_available?"bg-red-100 text-red-800":t.quantity_available<=t.reorder_level?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:0===t.quantity_available?"Out of Stock":t.quantity_available<=t.reorder_level?"Low Stock":"In Stock"})})]},t.product_id))})]})}),Math.ceil(j/f)>1&&e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-700 dark:text-gray-300",children:["Showing ",(b-1)*f+1," to ",Math.min(b*f,j)," of ",j," results"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{const e=Math.max(b-1,1);k(e),v(e)},disabled:1===b,className:"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsxs("span",{className:"px-3 py-1 text-sm text-gray-700 dark:text-gray-300",children:["Page ",b," of ",Math.ceil(j/f)]}),e.jsx("button",{onClick:()=>{const e=Math.min(b+1,Math.ceil(j/f));k(e),v(e)},disabled:b===Math.ceil(j/f),className:"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})}export{s as default};
